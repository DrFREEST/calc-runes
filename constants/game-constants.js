/**
 * ============================================================================
 * 마비노기 모바일 룬 효율 계산기 - 게임 상수 정의
 * ============================================================================
 * @file game-constants.js
 * @description 게임 관련 공통 상수 (등급, 역할, 각성, 시너지 등)
 * @author AI Assistant
 * @created 2025-12-11
 *
 * @architecture
 * - GRADE_BONUS: 등급별 효율 점수 보너스
 * - ROLE_MULTIPLIERS: 역할별 효과 가중치
 * - TYPE_WEIGHTS: 효과 유형별 가중치
 * - AWAKENING_CONSTANTS: 각성 관련 상수
 * - SYNERGY_BONUS: 시너지 보너스 값
 * - UPTIME_THRESHOLDS: 조건별 업타임 기준값
 * ============================================================================
 */

"use strict";

// ============================================================================
// 섹션 1: 등급별 효율 점수 보너스
// ============================================================================

/**
 * 등급별 효율 점수 보너스
 *
 * @constant {Object}
 * @description 룬 등급에 따른 기본 점수 보너스
 * @updated 2025-12-11 - 전설(시즌1)/신화만 계산 대상이므로 동일하게 설정
 */
const GRADE_BONUS = Object.freeze({
  /** 신화 등급 보너스 */
  MYTHIC: 0,

  /** 전설(시즌1) 등급 보너스 */
  LEGENDARY_S1: 0,

  /** 전설(시즌0) 등급 보너스 - 계산 대상 외 */
  LEGENDARY_S0: 0,

  /** 유니크(시즌0) 등급 보너스 - 계산 대상 외 */
  UNIQUE_S0: 0,
});

/**
 * 등급명으로 보너스 조회
 *
 * @constant {Object}
 * @updated 2025-12-11 - 모든 등급 보너스 동일 (0)
 */
const GRADE_BONUS_BY_NAME = Object.freeze({
  신화: GRADE_BONUS.MYTHIC,
  "전설(시즌1)": GRADE_BONUS.LEGENDARY_S1,
  "전설(시즌0)": GRADE_BONUS.LEGENDARY_S0,
  "유니크(시즌0)": GRADE_BONUS.UNIQUE_S0,
});

// ============================================================================
// 섹션 2: 역할별 효과 가중치
// ============================================================================

/**
 * 역할별 효과 가중치 배율
 *
 * @constant {Object}
 * @description 각 역할(딜러/탱커/힐러/밸런스)에 따른 효과별 가중치
 */
const ROLE_MULTIPLIERS = Object.freeze({
  /** 딜러 역할 가중치 */
  dealer: Object.freeze({
    "공격력 증가": 1.5,
    "피해량 증가": 1.5,
    "치명타 확률 증가": 1.2,
    "치명타 피해 증가": 1.2,
    "추가타 확률 증가": 1.2,
    "연타 피해 증가": 1.1,
    "강타 피해 증가": 1.1,
    "스킬 피해 증가": 1.1,
    "공격 속도 증가": 0.8,
    "스킬 사용 속도 증가": 0.8,
    "캐스팅/차지 속도 증가": 0.8,
    "쿨타임 회복 속도 증가": 1.0,
    "받는 피해 감소": 0.3,
    "회복력 증가": 0.2,
  }),

  /** 탱커 역할 가중치 */
  tank: Object.freeze({
    "받는 피해 감소": 2.0,
    "회복력 증가": 1.5,
    "공격력 증가": 0.5,
    "피해량 증가": 0.5,
    "치명타 확률 증가": 0.4,
    "치명타 피해 증가": 0.4,
  }),

  /** 힐러 역할 가중치 */
  healer: Object.freeze({
    "회복력 증가": 2.0,
    "쿨타임 회복 속도 증가": 1.5,
    "캐스팅/차지 속도 증가": 1.3,
    "스킬 사용 속도 증가": 1.2,
    "공격력 증가": 0.7,
    "피해량 증가": 0.5,
  }),

  /** 밸런스 역할 가중치 (기본값) */
  balanced: Object.freeze({
    "공격력 증가": 1.0,
    "피해량 증가": 1.0,
    "치명타 확률 증가": 0.9,
    "치명타 피해 증가": 0.8,
    "받는 피해 감소": 0.8,
    "회복력 증가": 0.6,
  }),
});

/**
 * 기본 역할 가중치 (매핑 안 된 효과용)
 *
 * @constant {number}
 */
const DEFAULT_ROLE_WEIGHT = 1.0;

// ============================================================================
// 섹션 3: 효과 유형별 가중치
// ============================================================================

/**
 * 효과 유형별 기본 가중치
 *
 * @constant {Object}
 * @description 효과 발동 유형에 따른 가중치
 */
const EFFECT_TYPE_WEIGHTS = Object.freeze({
  /** 상시 효과 */
  PERMANENT: 1.0,

  /** 중첩/축적 효과 (쉽게 최대 중첩 유지) */
  STACKING: 0.95,

  /** 트리거/조건 발동 효과 */
  TRIGGER: 0.8,

  /** HP/자원 상태 조건 효과 */
  STATE: 0.7,

  /** 적 상태 조건 효과 (시너지 없을 때) */
  ENEMY_CONDITION: 0.5,

  /** 지속시간/쿨타임 효과 (동적 계산) */
  DURATION: 0.5,

  /** 시간 감소 효과 */
  DECAY: 0.3,

  /** 기본값 (알 수 없는 유형) */
  DEFAULT: 0.7,
});

/**
 * 매핑 안 된 효과 기본 가중치
 *
 * @constant {number}
 */
const DEFAULT_EFFECT_WEIGHT = 0.5;

// ============================================================================
// 섹션 4: 각성 관련 상수
// ============================================================================

/**
 * 각성 관련 상수
 *
 * @constant {Object}
 */
const AWAKENING_CONSTANTS = Object.freeze({
  /** 기본 각성 쿨타임 (초) */
  BASE_COOLDOWN: 90,

  /** 기본 각성 지속시간 (초) */
  DEFAULT_DURATION: 20,

  /** 눈 먼 예언자 쿨타임 감소량 (초) */
  BLIND_PROPHET_REDUCTION: 38,

  /** 최소 각성 쿨타임 (초) */
  MIN_COOLDOWN: 30,
});

// ============================================================================
// 섹션 5: 시너지 보너스 상수
// ============================================================================

/**
 * 시너지 보너스 점수
 *
 * @constant {Object}
 */
const SYNERGY_BONUS = Object.freeze({
  /** DoT 부여 룬 1개당 보너스 */
  DOT_APPLY_PER_TYPE: 15,

  /** 결함 제거 시너지 (영원 룬) */
  DEMERIT_REMOVAL: 15,

  /** 각성 쿨타임 감소 시너지 */
  AWAKENING_COOLDOWN: 10,

  /** DoT 시너지 활성화 */
  DOT_SYNERGY: 8,

  /** 중첩 보너스 시너지 */
  STACKING_BONUS: 5,
});

/**
 * 클래스별 우선 효과 보너스
 *
 * @constant {number}
 * @description Sub 스텟(행운/의지) 관련 효과에 적용되는 보너스 배율
 * - 행운 Sub 클래스: 치명타, 추가타 효과 +25%
 * - 의지 Sub 클래스: 강타, 궁극기, 회복력 효과 +25%
 * @added 2025-12-11
 */
const CLASS_PRIORITY_BONUS = 0.25;

// ============================================================================
// 섹션 6: 조건별 업타임 기준값
// ============================================================================

/**
 * 체력/자원 조건별 업타임 기준값
 *
 * @constant {Object}
 * @description 어비스/레이드 기준 업타임 추정치
 */
const UPTIME_THRESHOLDS = Object.freeze({
  /** 체력 조건 업타임 */
  HEALTH: Object.freeze({
    /** 체력 75% 이상 유지 */
    ABOVE_75: 0.7,

    /** 체력 50% 이상 유지 */
    ABOVE_50: 0.8,

    /** 기타 이상 조건 */
    ABOVE_OTHER: 0.9,

    /** 체력 25% 이하 (매우 위험) */
    BELOW_25: 0.05,

    /** 체력 50% 이하 (위험) */
    BELOW_50: 0.15,

    /** 기타 이하 조건 */
    BELOW_OTHER: 0.3,
  }),

  /** 자원 조건 업타임 */
  RESOURCE: Object.freeze({
    /** 자원 33% 미만 */
    BELOW_33: 0.25,

    /** 자원 50% 미만 */
    BELOW_50: 0.4,

    /** 기타 미만 조건 */
    BELOW_OTHER: 0.5,
  }),

  /** 적 체력 조건 업타임 */
  ENEMY_HEALTH: Object.freeze({
    /** 적 체력 25% 이하 (처형) */
    BELOW_25: 0.25,

    /** 적 체력 50% 이하 */
    BELOW_50: 0.5,

    /** 기타 이하 조건 */
    BELOW_OTHER: 0.6,
  }),
});

// ============================================================================
// 섹션 7: 스텟 관련 상수
// ============================================================================

/**
 * 스텟 기본값
 *
 * @constant {Object}
 */
const STAT_DEFAULTS = Object.freeze({
  /** 스텟 입력 필드 기본값 (0이 아닌 1) */
  INPUT_DEFAULT: 1,

  /** 보너스 기본값 */
  BONUS_DEFAULT: 0,
});

/**
 * 스텟 환산 상수 (스텟 → 효과 환산)
 *
 * @constant {Object}
 */
const STAT_CONVERSION = Object.freeze({
  /** 치명타 스텟 100당 확률 증가 */
  CRIT_PER_100: 1,
});

// ============================================================================
// 섹션 8: 전투 시간 상수
// ============================================================================

/**
 * 전투 시간 기준값 (초)
 *
 * @constant {Object}
 */
const COMBAT_DURATION = Object.freeze({
  /** 레이드/어비스 보스 기준 */
  RAID_BOSS: 120,

  /** 일반 던전 기준 */
  DUNGEON: 60,

  /** 짧은 전투 기준 */
  SHORT: 30,
});

// ============================================================================
// 섹션 9: 모듈 내보내기
// ============================================================================

const GameConstants = {
  // 등급
  GRADE_BONUS,
  GRADE_BONUS_BY_NAME,

  // 역할
  ROLE_MULTIPLIERS,
  DEFAULT_ROLE_WEIGHT,

  // 효과 유형
  EFFECT_TYPE_WEIGHTS,
  DEFAULT_EFFECT_WEIGHT,

  // 각성
  AWAKENING_CONSTANTS,

  // 시너지
  SYNERGY_BONUS,

  // 클래스 우선 효과 보너스
  CLASS_PRIORITY_BONUS,

  // 업타임
  UPTIME_THRESHOLDS,

  // 스텟
  STAT_DEFAULTS,
  STAT_CONVERSION,

  // 전투 시간
  COMBAT_DURATION,
};

// ES6 모듈 환경
if (typeof module !== "undefined" && module.exports) {
  module.exports = GameConstants;
}

// 브라우저 환경 - 전역 객체에 등록
if (typeof window !== "undefined") {
  window.GameConstants = GameConstants;
}
